<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Policy Statement | JSON Policy</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="JSON Policy - Distributed Rule Engine">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.8968334b.css" as="style"><link rel="preload" href="/assets/js/app.c4123b23.js" as="script"><link rel="preload" href="/assets/js/2.d3ea8322.js" as="script"><link rel="preload" href="/assets/js/13.607e3aa6.js" as="script"><link rel="prefetch" href="/assets/js/10.5ee64c80.js"><link rel="prefetch" href="/assets/js/11.b3a8b447.js"><link rel="prefetch" href="/assets/js/12.29061add.js"><link rel="prefetch" href="/assets/js/14.8f8bcae9.js"><link rel="prefetch" href="/assets/js/15.e4a83481.js"><link rel="prefetch" href="/assets/js/16.bf02c3a1.js"><link rel="prefetch" href="/assets/js/17.5c717817.js"><link rel="prefetch" href="/assets/js/3.7c13d29b.js"><link rel="prefetch" href="/assets/js/4.b41e69dd.js"><link rel="prefetch" href="/assets/js/5.5bc5eaa4.js"><link rel="prefetch" href="/assets/js/6.e416f727.js"><link rel="prefetch" href="/assets/js/7.980d9cb6.js"><link rel="prefetch" href="/assets/js/8.39ee49f0.js"><link rel="prefetch" href="/assets/js/9.aba5de70.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8968334b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.svg" alt="JSON Policy" class="logo"> <span class="site-name can-hide">JSON Policy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/overview/" class="nav-link router-link-active">
  Overview
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Libraries" class="dropdown-title"><span class="title">Libraries</span> <span class="arrow down"></span></button> <button type="button" aria-label="Libraries" class="mobile-dropdown-title"><span class="title">Libraries</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/php-library/" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/js-library/" class="nav-link">
  JavaScript
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/overview/" class="nav-link router-link-active">
  Overview
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Libraries" class="dropdown-title"><span class="title">Libraries</span> <span class="arrow down"></span></button> <button type="button" aria-label="Libraries" class="mobile-dropdown-title"><span class="title">Libraries</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/php-library/" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/js-library/" class="nav-link">
  JavaScript
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Overview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/overview/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/overview/policy-statement.html" aria-current="page" class="active sidebar-link">Policy Statement</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/overview/policy-statement.html#effect" class="sidebar-link">Effect</a></li><li class="sidebar-sub-header"><a href="/overview/policy-statement.html#enforce" class="sidebar-link">Enforce</a></li><li class="sidebar-sub-header"><a href="/overview/policy-statement.html#resource" class="sidebar-link">Resource</a></li><li class="sidebar-sub-header"><a href="/overview/policy-statement.html#action" class="sidebar-link">Action</a></li><li class="sidebar-sub-header"><a href="/overview/policy-statement.html#condition" class="sidebar-link">Condition</a></li></ul></li><li><a href="/overview/policy-param.html" class="sidebar-link">Policy Param</a></li><li><a href="/overview/policy-condition.html" class="sidebar-link">Policy Condition</a></li><li><a href="/overview/policy-marker.html" class="sidebar-link">Policy Marker</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="policy-statement"><a href="#policy-statement" class="header-anchor">#</a> Policy Statement</h1> <p>The policy statement defines one or more <code>resources</code> that the application can work within the current context. In other words, the policy statement tells the application if certain components may or may not be executed depending on some predetermined conditions.</p> <p>For example, the below statement restricts user registration if requests come from outside of the USA as well as over the weekends.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deny&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UserRegistration&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Condition&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Operator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OR&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;NotEquals&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;${IDENTITY.location.country_code}&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USA&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;In&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;${DATETIME.D}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;Sat&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;Sun&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>As you can see, it becomes relatively easy to define any conditional logic and make changes over time without a need to touch the existing codebase.</p> <p>Below I'm going over each supported statement's attribute in more detail.</p> <h2 id="effect"><a href="#effect" class="header-anchor">#</a> Effect</h2> <ul><li>Type: <code>String</code></li> <li><strong>Required</strong></li></ul> <p>The <code>Effect</code> attribute defines if <code>resources</code> or combination of <code>resources</code> and <code>actions</code> are &quot;allowed&quot; or &quot;denied&quot;. I'm deliberately wrapping &quot;allowed&quot; and &quot;denied&quot; keywords into quotes to emphasize the fact that the effect can be as verbose as you wish.</p> <p>For example, you may prefer to use keywords like &quot;permit&quot; and &quot;restrict&quot; instead or certain <code>resources</code> are defined to be &quot;attached&quot; or &quot;detached&quot;.</p> <p>By default, all the available libraries support <code>allow</code> and <code>deny</code> effects and developers have the ability to declare a custom collection of stems for more verbose implementation.</p> <blockquote><p><strong>FYI!</strong> For more details about custom effects, please refer to the respective language library reference page.</p></blockquote> <p>The reserved <code>Effect</code> attribute as well as its value are both case-sensitive, so &quot;Allow&quot; is not equals to &quot;allow&quot;. That is why please be extra cautious defining this attribute.</p> <h2 id="enforce"><a href="#enforce" class="header-anchor">#</a> Enforce</h2> <ul><li>Type: <code>Boolean</code></li> <li><em>Optional</em></li></ul> <p>The <code>Enforce</code> attributes prioritize the applicable statement over other applicable statements that target the same <code>resource</code> or combinations of <code>resource/action</code>. It basically works exactly the same way as <code>!important</code> tag in CSS stylesheets.</p> <blockquote><p><strong>Note!</strong> The &quot;applicable&quot; statement is the statement that either does not have any conditions or defined conditions evaluate to <code>true</code>.</p></blockquote> <p>If there are two or more enforced and applicable statements that target the same <code>resource</code>, then the last declared statement is used.</p> <p>In the example below, there are two statements that target the same action <code>trade</code> for the resource <code>Car</code>, however, the user will be denied to trade the car because this action is enforced to be denied.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Statement&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deny&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Enforce&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Car&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token string">&quot;trade&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Car&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;purchase&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;trade&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="resource"><a href="#resource" class="header-anchor">#</a> Resource</h2> <ul><li>Type: <code>String|Array</code></li> <li><strong>Required</strong></li></ul> <p>The <code>Resource</code> attribute contains either a single string value or an array of string that represents an application's resources.</p> <p>The resource can be anything. It can be an object or even some very specific method of an object. It is up to you to define application resources and actions that can be performed upon them.</p> <p>By default, the JSON policy framework converts an object into a string by taking the class name of the instance. However, if the passed resource is already a string, then it is taken as-is.</p> <p>In the example below, I'm declaring two statements that target a completely different type of resources when the first one restrict access to tasks that belong to the protected category &quot;Accounting&quot; and the second statement completed restricts the ability to delete any tasks.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Statement&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deny&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Task&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Condition&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;In&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;${Task.category}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;Accounting&quot;</span>
                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deny&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;delete-tasks&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Resources can be declared dynamically by using <a href="/overview/policy-marker.html">markers</a>. This is extremely useful when you do not have the ability to foresee every possible resource that your application may work with.</p> <p>For example, let's say you want to allow a user to the category that has the exact name that the user's email address. In this case, the statement may look something like this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;allow&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Category:${USER.email_address}&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>Resource</code> attribute may also contain the specially reserved <code>=&gt;</code> mapping operand. It basically allows you to build the list of resources dynamically from giving <a href="/overview/policy-marker.html">marker</a> that contains an array of scalar values. These values are used to replace the <code>%s</code> and build the final name for each resource.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;restrict&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Article:%s =&gt; ${CONTEXT.RestrictedArticles}&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>RestrictedArticles</code> property contains the array of article names that are restricted.</p> <h2 id="action"><a href="#action" class="header-anchor">#</a> Action</h2> <ul><li>Type: <code>String|Array</code></li> <li><em>Optional</em></li></ul> <p>The <code>Action</code> attribute is the optional attribute and may or may not exist based on the type of resources.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;allow&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;update&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;create&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;delete&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><strong>Note!</strong> The <code>Action</code> attribute does not allow markers inside to improve policy readability and an application security pasture.</p></blockquote> <h2 id="condition"><a href="#condition" class="header-anchor">#</a> Condition</h2> <ul><li>Type: <code>{ Equals: Object, NotEquals: Object, ... }: Object</code></li> <li><em>Optional</em></li></ul> <p>The <code>Condition</code> attribute is also the optional attribute and contains a collection of conditions that if meat, classify the statement as applicable. This is very helpful when some restrictions or allowances have to be applied only when certain conditions are fulfilled.</p> <blockquote><p><strong>Note!</strong> Conditions are discussed in greater details in the &quot;<a href="/overview/policy-condition.html">Policy Condition</a>&quot; section.</p></blockquote> <p>For example, you may allow a user that has the administrator role to be able to manage other users with the statement like this:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;allow&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;view&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;update&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;create&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;delete&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;suspend&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Condition&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;In&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;administrator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;(*array)${USER.roles}&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><strong>FYI!</strong> The type casting <code>(*array)</code> is discussed in more detail in the &quot;<a href="/overview/policy-marker.html#type-casting">Type Casting</a>&quot; section</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/overview/" class="prev router-link-active">
        Introduction
      </a></span> <span class="next"><a href="/overview/policy-param.html">
        Policy Param
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c4123b23.js" defer></script><script src="/assets/js/2.d3ea8322.js" defer></script><script src="/assets/js/13.607e3aa6.js" defer></script>
  </body>
</html>
